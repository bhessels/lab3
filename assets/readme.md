need to fix one or two bugs with dot density.